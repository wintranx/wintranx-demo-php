<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css">
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/global.css">
	<script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
	<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script src="./js/plug.js"></script>
    <title>Wintranx - Demo</title>
</head>
<body>
    <div id="wintranx">
        <div class="header clearfix">
            <p class="title"><img src="https://business.wintranx.com/images/logo.png" class="logo">Demo - PageSell</p>
            <div class="btn-group">
                <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">切换接口 
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu pull-right" role="menu">
                    <li><a href="/demo/authorize.html">Authorize</a></li>
                    <li class="divider"></li>
                    <li><a href="/demo/capture.html">Capture</a></li>
                    <li class="divider"></li>
                    <li><a href="/demo/refund.html">Refund</a></li>
                    <li class="divider"></li>
                    <li><a href="/demo/sale.html">Sale</a></li>
                    <li class="divider"></li>
                    <li><a href="/demo/void.html">Void</a></li>
                    <li class="divider"></li>
                    <li><a href="/demo/queryTran.html">QueryTran</a></li>
                    <li class="divider"></li>
                    <li><a href="/demo/pageSell.html">PageSell</a></li>
                    <li class="divider"></li>
                    <li><a href="/demo/sessionSale.html">SessionSale</a></li>
                </ul>
            </div>
        </div>
        <div class="main">
            <div class="row">
                <div class="col-xs-12 result-form">
                    <p class="title">请求参数</p>
                    <div class="result-form-body">
                        <div class="r-f-b-block">
                            <p class="title">Certificate</p>
                            <p class="detail">
                                <span class="d-label">Account Id</span>
                                <span class="d-symbol"> = </span>
                                <span class="d-input"><input type="text" id="accountId" value="ACT90001"></span>
                            </p>
                            <p class="detail">
                                <span class="d-label">Notify Url</span>
                                <span class="d-symbol"> = </span>
                                <span class="d-input"><input type="text" id="notifyUrl" value="http://192.168.10.17:8551/notice/success"></span>
                            </p>
                            <p class="detail">
                                <span class="d-label">shopperUrl</span>
                                <span class="d-symbol"> = </span>
                                <span class="d-input"><input type="text" id="shopperUrl" value="http://192.168.10.17:8551/notice/success"></span>
                            </p>
                            <p class="detail">
                                <span class="d-label">merOrderId</span>
                                <span class="d-symbol"> = </span>
                                <span class="d-input"><input type="text" id="merOrderId" value=""></span>
                            </p>
                            <p class="detail">
                                <span class="d-label">merTradeId</span>
                                <span class="d-symbol"> = </span>
                                <span class="d-input"><input type="text" id="merTradeId" value=""></span>
                            </p>
                            <p class="detail">
                                <span class="d-label">amount.currency</span>
                                <span class="d-symbol"> = </span>
                                <span class="d-input"><input type="text" id="currency" value=""></span>
                            </p>
                            <p class="detail detail-exp">
                                Example：USD EUR GBP AUD CHF MYR IDR JPY HKD CAD SGD NZD THB KRW CNY
                            </p>
                            <p class="detail">
                                <span class="d-label">amount.value</span>
                                <span class="d-symbol"> = </span>
                                <span class="d-input"><input type="text" id="amount" value="1.00"></span>
                            </p>
                        </div>
                        <div class="r-f-b-block">
                            <p class="title">Other
                                <a data-toggle="collapse" data-parent="#accordion" class="collapse-btn" href="#collapseThree" aria-expanded="false">
                                    <i class="fa fa-chevron-up"></i>
                                    <i class="fa fa-chevron-down"></i>
                                </a>
                            </p>
                            <div id="collapseThree" class="panel-collapse collapse">
                                <p class="detail">
                                    <span class="d-label">Basket</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="basket" value='[{"amountPerItem":"79.00","quantity":"3","productName":"goodname1","productSku":"sku100001"},{"amountPerItem":"67.00","quantity":"4","productName":"goodname2","productSku":"sku100002"}]'></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">customerData</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="customerData" value='CSDUSD'></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">version</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="version" value='1.0'></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">deliveryAddressInfo</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="deliveryAddress" value='{"country":"US","firstName":"JiaXi","lastName":"Li","stateOrProvince":"NY","city":"New York","phone":"13226264455","houseNumberOrName":"11","street":"1295 Charleston Road","postalCode":"200120","email":"review@cybersource.com"}'></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">billingAddress info</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="billingAddress" value='{"country":"US","firstName":"JiaXi","lastName":"Li","stateOrProvince":"NY","city":"New York","phone":"13226264455","houseNumberOrName":"11","street":"1295 Charleston Road","postalCode":"200120","email":"review@cybersource.com"}'></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">merDescribe info</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merDescribe" value='{"merchantPhone":"15821900322","merchantName":"merchantName7890"}'></span>
                                </p>
                            </div>
                        </div>
                        <div class="r-f-b-block">
                            <p class="title">Mdd Data
                                <a data-toggle="collapse" data-parent="#accordion" class="collapse-btn" href="#collapseFour" aria-expanded="false">
                                    <i class="fa fa-chevron-up"></i>
                                    <i class="fa fa-chevron-down"></i>
                                </a>
                            </p>
                            <div id="collapseFour" class="panel-collapse collapse">
                                <p class="detail">
                                    <span class="d-label">Mdd Data 21</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_21" value='orderNumber123' placeholder="mddData.merchantDefinedData_mddField_21"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 22</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_22" value='PC' placeholder="mddData.merchantDefinedData_mddField_22"></span>
                                </p>                                
                                <p class="detail">
                                    <span class="d-label">Mdd Data 23</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_23" value='Favorites' placeholder="mddData.merchantDefinedData_mddField_23"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 24</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_24" value='lijiaxi' placeholder="mddData.merchantDefinedData_mddField_24"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 25</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_25" value='30' placeholder="mddData.merchantDefinedData_mddField_25"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 26</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_26" value='N' placeholder="mddData.merchantDefinedData_mddField_26"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 27</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_27" value='Y' placeholder="mddData.merchantDefinedData_mddField_27"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 28</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_28" value='review@cybersource.com' placeholder="mddData.merchantDefinedData_mddField_28"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 29</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_29" value='cybersource.com' placeholder="mddData.merchantDefinedData_mddField_29"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 30</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_30" value='Y' placeholder="mddData.merchantDefinedData_mddField_30"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 31</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_31" value='Y' placeholder="mddData.merchantDefinedData_mddField_31"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 32</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_32" value='Y' placeholder="mddData.merchantDefinedData_mddField_32"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 33</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_33" value='Y' placeholder="mddData.merchantDefinedData_mddField_33"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 34</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_34" value='applepay' placeholder="mddData.merchantDefinedData_mddField_34"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 35</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_35" value='Y' placeholder="mddData.merchantDefinedData_mddField_35"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 36</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_36" value='512345' placeholder="mddData.merchantDefinedData_mddField_36"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 37</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_37" value='CN' placeholder="mddData.merchantDefinedData_mddField_37"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 38</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_38" value='Y' placeholder="mddData.merchantDefinedData_mddField_38"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 39</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_39" value='www.shopper.com' placeholder="mddData.merchantDefinedData_mddField_39"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 40</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_40" value='Electronic Product' placeholder="mddData.merchantDefinedData_mddField_40"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 41</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_41" value='Y' placeholder="mddData.merchantDefinedData_mddField_41"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 42</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_42" value='Y' placeholder="mddData.merchantDefinedData_mddField_42"></span>
                                </p>
                                <p class="detail">
                                    <span class="d-label">Mdd Data 43</span>
                                    <span class="d-symbol"> = </span>
                                    <span class="d-input"><input type="text" id="merchantDefinedData_mddField_43" value='normal' placeholder="mddData.merchantDefinedData_mddField_43"></span>
                                </p>
                            </div>
                        </div>
                        <div class="r-f-b-block">
                            <button type="button" class="btn btn-primary" id="sendPost">发送请求</button>

                            <form action="http://test.api.wintranx.com/wintranx-order/api/transaction/goPayPage" id="saleForm" method="post">
                                <input type="hidden" name="requestJson" id="requestJson" value='' />
                          </form>
                          
                        </div>
                        <script>
                            $(function () {
                                $('#toSecure').hide();
                                $('#merOrderId').val(`${Math.round(new Date())}${getRandomNumber(999999, 100000)}`);
                                $('#merTradeId').val(`${Math.round(new Date())}${getRandomNumber(999999, 100000)}`);
                                const currency = getCurrency();
                                if(currency === 'IDR' || currency === 'KRW' || currency === 'JPY') {
                                    $('#amount').val(getRandomNumber(100, 1));
                                } else {
                                    $('#amount').val(`${getRandomNumber(100, 1)}.00`);
                                }
                                $('#currency').val(currency);
                     
                                $('#sendPost').on('click', () => {
                                     $('#sendPost').hide();
                                     let data = {
                                         accountId: $('#accountId').val(),
                                         merOrderId: $('#merOrderId').val(),
                                         merTradeId: $('#merTradeId').val(),
                                         amount: {
                                             currency: $('#currency').val(),
                                             value: $('#amount').val(),
                                         },
                                         card: {
                                             firstName: $('#firstName').val(),
                                             lastName: $('#lastName').val(),
                                             number: $('#number').val(),
                                             cvc: $('#cvc').val(),
                                             expiryMonth: $('#expiryMonth').val(),
                                             expiryYear: $('#expiryYear').val(),
                                         },
                                         basket: $('#basket').val(),
                                         shopperIP: $('#shopperIP').val(),
                                         customerData: $('#customerData').val(),
                                         version: $('#version').val(),
                                         deliveryAddress: $('#deliveryAddress').val(),
                                         notifyUrl: $('#notifyUrl').val(),
                                         billingAddress: $('#billingAddress').val(),
                                         merDescribe: $('#merDescribe').val(),
                                         shopperUrl: $('#shopperUrl').val(),
                                         mddData: {
                                            merchantDefinedData_mddField_21: $('#merchantDefinedData_mddField_21').val(),
                                            merchantDefinedData_mddField_22: $('#merchantDefinedData_mddField_22').val(),
                                            merchantDefinedData_mddField_23: $('#merchantDefinedData_mddField_23').val(),
                                            merchantDefinedData_mddField_24: $('#merchantDefinedData_mddField_24').val(),
                                            merchantDefinedData_mddField_25: $('#merchantDefinedData_mddField_25').val(),
                                            merchantDefinedData_mddField_26: $('#merchantDefinedData_mddField_26').val(),
                                            merchantDefinedData_mddField_27: $('#merchantDefinedData_mddField_27').val(),
                                            merchantDefinedData_mddField_28: $('#merchantDefinedData_mddField_28').val(),
                                            merchantDefinedData_mddField_29: $('#merchantDefinedData_mddField_29').val(),
                                            merchantDefinedData_mddField_30: $('#merchantDefinedData_mddField_30').val(),
                                            merchantDefinedData_mddField_31: $('#merchantDefinedData_mddField_31').val(),
                                            merchantDefinedData_mddField_32: $('#merchantDefinedData_mddField_32').val(),
                                            merchantDefinedData_mddField_33: $('#merchantDefinedData_mddField_33').val(),
                                            merchantDefinedData_mddField_34: $('#merchantDefinedData_mddField_34').val(),
                                            merchantDefinedData_mddField_35: $('#merchantDefinedData_mddField_35').val(),
                                            merchantDefinedData_mddField_36: $('#merchantDefinedData_mddField_36').val(),
                                            merchantDefinedData_mddField_37: $('#merchantDefinedData_mddField_37').val(),
                                            merchantDefinedData_mddField_38: $('#merchantDefinedData_mddField_38').val(),
                                            merchantDefinedData_mddField_39: $('#merchantDefinedData_mddField_39').val(),
                                            merchantDefinedData_mddField_40: $('#merchantDefinedData_mddField_40').val(),
                                            merchantDefinedData_mddField_41: $('#merchantDefinedData_mddField_41').val(),
                                            merchantDefinedData_mddField_42: $('#merchantDefinedData_mddField_42').val(),
                                            merchantDefinedData_mddField_43: $('#merchantDefinedData_mddField_43').val(),
                                         },
                                    };

                                    $.ajax({
                                        type:"POST",
                                        url: '/payment/pageSell.php',
                                        data: data,
                                        dataType:"json",
                                        success:function(res){  
                                            $('#requestJson').val( JSON.stringify(res.requestJson));
                                            $('#saleForm').submit();
                                        },
                                        error:function(res){
                                            console.error(res);
                                            $('#sendPost').show();
                                        }
                                    });
                                });
                            
                                $('#toSecure').on('click', () => {
                                    let html = $('#toSecure').data('url');
                                    window.location.href = html
                                })
                            })
                         </script>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>